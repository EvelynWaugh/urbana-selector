import{$ as Hs,r as q,n as me,o as W,q as $e,v as Ks,j as e,w as Js,x as Ns,y as Ys,u as fe,z as Zs,A as Xs,c as je,B as ve,C as re,D as Qs,f as _e,a as et,E as ws,F as Ps,G as st,J as tt,K as rt,L as at,M as it,g as nt,h as ot,R as z,b as k,I as u,d as A,e as $,i as Y,t as ce,s as be,l as ye,N as lt,k as Rs,m as ct,H as dt}from"./middleware.js";import{u as De,c as L,d as Xe,a as Qe,b as es,m as ie,e as Ce,f as Se,g as ke,h as Fe,i as Te}from"./index.js";import{u as ut,f as mt,i as _s,t as Ee,a as U,c as Ds,d as Cs,b as os,e as ls,T as pt}from"./chunk-HO5AVL6Z.js";import"./features-animation.js";let Le=new Map,Ve=!1;try{Ve=new Intl.NumberFormat("de-DE",{signDisplay:"exceptZero"}).resolvedOptions().signDisplay==="exceptZero"}catch{}let Ne=!1;try{Ne=new Intl.NumberFormat("de-DE",{style:"unit",unit:"degree"}).resolvedOptions().style==="unit"}catch{}const Ss={degree:{narrow:{default:"°","ja-JP":" 度","zh-TW":"度","sl-SI":" °"}}};class ht{format(a){let t="";if(!Ve&&this.options.signDisplay!=null?t=gt(this.numberFormatter,this.options.signDisplay,a):t=this.numberFormatter.format(a),this.options.style==="unit"&&!Ne){var r;let{unit:i,unitDisplay:n="short",locale:o}=this.resolvedOptions();if(!i)return t;let c=(r=Ss[i])===null||r===void 0?void 0:r[n];t+=c[o]||c.default}return t}formatToParts(a){return this.numberFormatter.formatToParts(a)}formatRange(a,t){if(typeof this.numberFormatter.formatRange=="function")return this.numberFormatter.formatRange(a,t);if(t<a)throw new RangeError("End date must be >= start date");return`${this.format(a)} – ${this.format(t)}`}formatRangeToParts(a,t){if(typeof this.numberFormatter.formatRangeToParts=="function")return this.numberFormatter.formatRangeToParts(a,t);if(t<a)throw new RangeError("End date must be >= start date");let r=this.numberFormatter.formatToParts(a),i=this.numberFormatter.formatToParts(t);return[...r.map(n=>({...n,source:"startRange"})),{type:"literal",value:" – ",source:"shared"},...i.map(n=>({...n,source:"endRange"}))]}resolvedOptions(){let a=this.numberFormatter.resolvedOptions();return!Ve&&this.options.signDisplay!=null&&(a={...a,signDisplay:this.options.signDisplay}),!Ne&&this.options.style==="unit"&&(a={...a,style:"unit",unit:this.options.unit,unitDisplay:this.options.unitDisplay}),a}constructor(a,t={}){this.numberFormatter=xt(a,t),this.options=t}}function xt(s,a={}){let{numberingSystem:t}=a;if(t&&s.includes("-nu-")&&(s.includes("-u-")||(s+="-u-"),s+=`-nu-${t}`),a.style==="unit"&&!Ne){var r;let{unit:o,unitDisplay:c="short"}=a;if(!o)throw new Error('unit option must be provided with style: "unit"');if(!(!((r=Ss[o])===null||r===void 0)&&r[c]))throw new Error(`Unsupported unit ${o} with unitDisplay = ${c}`);a={...a,style:"decimal"}}let i=s+(a?Object.entries(a).sort((o,c)=>o[0]<c[0]?-1:1).join():"");if(Le.has(i))return Le.get(i);let n=new Intl.NumberFormat(s,a);return Le.set(i,n),n}function gt(s,a,t){if(a==="auto")return s.format(t);if(a==="never")return s.format(Math.abs(t));{let r=!1;if(a==="always"?r=t>0||Object.is(t,0):a==="exceptZero"&&(Object.is(t,-0)||Object.is(t,0)?t=Math.abs(t):r=t>0),r){let i=s.format(-t),n=s.format(t),o=i.replace(n,"").replace(/\u200e|\u061C/,"");return[...o].length!==1&&console.warn("@react-aria/i18n polyfill for NumberFormat signDisplay: Unsupported case"),i.replace(n,"!!!").replace(o,"+").replace("!!!",n)}else return s.format(t)}}function ft(s={}){let{locale:a}=Hs();return q.useMemo(()=>new ht(a,s),[a,s])}var cs=me({slots:{base:"flex flex-col gap-2 w-full",label:"",labelWrapper:"flex justify-between",value:"",track:"z-0 relative bg-default-300/50 overflow-hidden rtl:rotate-180",indicator:"h-full"},variants:{color:{default:{indicator:"bg-default-400"},primary:{indicator:"bg-primary"},secondary:{indicator:"bg-secondary"},success:{indicator:"bg-success"},warning:{indicator:"bg-warning"},danger:{indicator:"bg-danger"}},size:{sm:{label:"text-small",value:"text-small",track:"h-1"},md:{label:"text-medium",value:"text-medium",track:"h-3"},lg:{label:"text-large",value:"text-large",track:"h-5"}},radius:{none:{track:"rounded-none",indicator:"rounded-none"},sm:{track:"rounded-small",indicator:"rounded-small"},md:{track:"rounded-medium",indicator:"rounded-medium"},lg:{track:"rounded-large",indicator:"rounded-large"},full:{track:"rounded-full",indicator:"rounded-full"}},isStriped:{true:{indicator:"bg-stripe-gradient-default bg-stripe-size"}},isIndeterminate:{true:{indicator:["absolute","w-full","origin-left","animate-indeterminate-bar"]}},isDisabled:{true:{base:"opacity-disabled cursor-not-allowed"}},disableAnimation:{true:{},false:{indicator:"transition-transform !duration-500"}}},defaultVariants:{color:"primary",size:"md",radius:"full",isStriped:!1,isIndeterminate:!1,isDisabled:!1},compoundVariants:[{disableAnimation:!0,isIndeterminate:!1,class:{indicator:"!transition-none motion-reduce:transition-none"}},{color:"primary",isStriped:!0,class:{indicator:"bg-stripe-gradient-primary bg-stripe-size"}},{color:"secondary",isStriped:!0,class:{indicator:"bg-stripe-gradient-secondary bg-stripe-size"}},{color:"success",isStriped:!0,class:{indicator:"bg-stripe-gradient-success bg-stripe-size"}},{color:"warning",isStriped:!0,class:{indicator:"bg-stripe-gradient-warning bg-stripe-size"}},{color:"danger",isStriped:!0,class:{indicator:"bg-stripe-gradient-danger bg-stripe-size"}}]},{twMerge:!0});me({slots:{base:"flex flex-col justify-center gap-1 max-w-fit items-center",label:"",svgWrapper:"relative block",svg:"z-0 relative overflow-hidden",track:"h-full stroke-default-300/50",indicator:"h-full stroke-current",value:"absolute font-normal inset-0 flex items-center justify-center"},variants:{color:{default:{svg:"text-default-400"},primary:{svg:"text-primary"},secondary:{svg:"text-secondary"},success:{svg:"text-success"},warning:{svg:"text-warning"},danger:{svg:"text-danger"}},size:{sm:{svg:"w-8 h-8",label:"text-small",value:"text-[0.5rem]"},md:{svg:"w-10 h-10",label:"text-small",value:"text-[0.55rem]"},lg:{svg:"w-12 h-12",label:"text-medium",value:"text-[0.6rem]"}},isIndeterminate:{true:{svg:"animate-spinner-ease-spin"}},isDisabled:{true:{base:"opacity-disabled cursor-not-allowed"}},disableAnimation:{true:{},false:{indicator:"transition-all !duration-500"}}},defaultVariants:{color:"primary",size:"md",isDisabled:!1},compoundVariants:[{disableAnimation:!0,isIndeterminate:!1,class:{svg:"!transition-none motion-reduce:transition-none"}}]});var ds=me({base:["px-2","py-1","h-fit","font-mono","font-normal","inline-block","whitespace-nowrap"],variants:{color:{default:W.flat.default,primary:W.flat.primary,secondary:W.flat.secondary,success:W.flat.success,warning:W.flat.warning,danger:W.flat.danger},size:{sm:"text-small",md:"text-medium",lg:"text-large"},radius:{none:"rounded-none",sm:"rounded-small",md:"rounded-medium",lg:"rounded-large",full:"rounded-full"}},defaultVariants:{color:"default",size:"sm",radius:"sm"}}),jt=me({slots:{base:["flex","relative","justify-center","items-center","box-border","overflow-hidden","align-middle","text-white","z-0",...Ks],img:["flex","object-cover","w-full","h-full","transition-opacity","!duration-500","opacity-0","data-[loaded=true]:opacity-100"],fallback:[...$e,"flex","items-center","justify-center"],name:[...$e,"font-normal","text-center","text-inherit"],icon:[...$e,"flex","items-center","justify-center","text-inherit","w-full","h-full"]},variants:{size:{sm:{base:"w-8 h-8 text-tiny"},md:{base:"w-10 h-10 text-tiny"},lg:{base:"w-14 h-14 text-small"}},color:{default:{base:W.solid.default},primary:{base:W.solid.primary},secondary:{base:W.solid.secondary},success:{base:W.solid.success},warning:{base:W.solid.warning},danger:{base:W.solid.danger}},radius:{none:{base:"rounded-none"},sm:{base:"rounded-small"},md:{base:"rounded-medium"},lg:{base:"rounded-large"},full:{base:"rounded-full"}},isBordered:{true:{base:"ring-2 ring-offset-2 ring-offset-background dark:ring-offset-background-dark"}},isDisabled:{true:{base:"opacity-disabled"}},isInGroup:{true:{base:["-ms-2 data-[hover=true]:-translate-x-3 rtl:data-[hover=true]:translate-x-3 transition-transform","data-[focus-visible=true]:-translate-x-3 rtl:data-[focus-visible=true]:translate-x-3"]}},isInGridGroup:{true:{base:"m-0 data-[hover=true]:translate-x-0"}},disableAnimation:{true:{base:"transition-none",img:"transition-none"},false:{}}},defaultVariants:{size:"md",color:"default",radius:"full"},compoundVariants:[{color:"default",isBordered:!0,class:{base:"ring-default"}},{color:"primary",isBordered:!0,class:{base:"ring-primary"}},{color:"secondary",isBordered:!0,class:{base:"ring-secondary"}},{color:"success",isBordered:!0,class:{base:"ring-success"}},{color:"warning",isBordered:!0,class:{base:"ring-warning"}},{color:"danger",isBordered:!0,class:{base:"ring-danger"}}]});me({slots:{base:"flex items-center justify-center h-auto w-max",count:"hover:-translate-x-0"},variants:{isGrid:{true:"inline-grid grid-cols-4 gap-3"}}});var vt=()=>e.jsxs("svg",{"aria-hidden":"true",fill:"none",height:"80%",role:"presentation",viewBox:"0 0 24 24",width:"80%",children:[e.jsx("path",{d:"M12 2C9.38 2 7.25 4.13 7.25 6.75C7.25 9.32 9.26 11.4 11.88 11.49C11.96 11.48 12.04 11.48 12.1 11.49C12.12 11.49 12.13 11.49 12.15 11.49C12.16 11.49 12.16 11.49 12.17 11.49C14.73 11.4 16.74 9.32 16.75 6.75C16.75 4.13 14.62 2 12 2Z",fill:"currentColor"}),e.jsx("path",{d:"M17.0809 14.1489C14.2909 12.2889 9.74094 12.2889 6.93094 14.1489C5.66094 14.9989 4.96094 16.1489 4.96094 17.3789C4.96094 18.6089 5.66094 19.7489 6.92094 20.5889C8.32094 21.5289 10.1609 21.9989 12.0009 21.9989C13.8409 21.9989 15.6809 21.5289 17.0809 20.5889C18.3409 19.7389 19.0409 18.5989 19.0409 17.3589C19.0309 16.1289 18.3409 14.9889 17.0809 14.1489Z",fill:"currentColor"})]}),[tr,bt]=Js({name:"AvatarGroupContext",strict:!1});function yt(s={}){var a,t,r,i,n,o,c,m;const g=Ns(),h=bt(),v=!!h,{as:p,ref:D,src:y,name:F,icon:I,classNames:O,fallback:w,alt:S=F||"avatar",imgRef:E,color:G=(a=h==null?void 0:h.color)!=null?a:"default",radius:b=(t=h==null?void 0:h.radius)!=null?t:"full",size:N=(r=h==null?void 0:h.size)!=null?r:"md",isBordered:j=(i=h==null?void 0:h.isBordered)!=null?i:!1,isDisabled:R=(n=h==null?void 0:h.isDisabled)!=null?n:!1,isFocusable:d=!1,getInitials:P=Ys,ignoreFallback:T=!1,showFallback:f=!1,ImgComponent:l="img",imgProps:x,className:C,onError:M,disableAnimation:_,...B}=s,Z=p||"span",Ae=fe(D),Ie=fe(E),{isFocusVisible:$s,isFocused:Ls,focusProps:rs}=Zs(),{isHovered:Bs,hoverProps:Us}=Xs({isDisabled:R}),he=(o=_??(g==null?void 0:g.disableAnimation))!=null?o:!1,as=(m=typeof l=="object"&&((c=l==null?void 0:l.displayName)==null?void 0:c.includes("HeroUI")))!=null?m:!1,xe=ut({src:y,onError:M,ignoreFallback:T,shouldBypassImageLoad:p!==void 0||l!=="img"&&!as})==="loaded",is=!as,qs=(!y||!xe)&&f,le=q.useMemo(()=>{var Q;return jt({color:G,radius:b,size:N,isBordered:j,isDisabled:R,isInGroup:v,disableAnimation:he,isInGridGroup:(Q=h==null?void 0:h.isGrid)!=null?Q:!1})},[G,b,N,j,R,he,v,h==null?void 0:h.isGrid]),ns=je(O==null?void 0:O.base,C),Me=q.useMemo(()=>d||p==="button",[d,p]),Vs=q.useCallback((Q={})=>({ref:Ae,tabIndex:Me?0:-1,"data-hover":re(Bs),"data-focus":re(Ls),"data-focus-visible":re($s),className:le.base({class:je(ns,Q==null?void 0:Q.className)}),...ve(B,Us,Me?rs:{})}),[Me,le,ns,rs,B]),Ws=q.useCallback((Q={})=>({ref:Ie,src:y,"data-loaded":re(xe),className:le.img({class:O==null?void 0:O.img}),...ve(x,Q,Qs({disableAnimation:he},{enabled:is}))}),[le,xe,x,he,y,Ie,is]);return{Component:Z,ImgComponent:l,src:y,alt:S,icon:I,name:F,imgRef:Ie,slots:le,classNames:O,fallback:w,isImgLoaded:xe,showFallback:qs,ignoreFallback:T,getInitials:P,getAvatarProps:Vs,getImageProps:Ws}}var ks=_e((s,a)=>{const{Component:t,ImgComponent:r,src:i,icon:n=e.jsx(vt,{}),alt:o,classNames:c,slots:m,name:g,showFallback:h,fallback:v,getInitials:p,getAvatarProps:D,getImageProps:y}=yt({...s,ref:a}),F=q.useMemo(()=>!h&&i?null:v?e.jsx("div",{"aria-label":o,className:m.fallback({class:c==null?void 0:c.fallback}),role:"img",children:v}):g?e.jsx("span",{"aria-label":o,className:m.name({class:c==null?void 0:c.name}),role:"img",children:p(g)}):e.jsx("span",{"aria-label":o,className:m.icon({class:c==null?void 0:c.icon}),role:"img",children:n}),[h,i,v,g,c]);return e.jsxs(t,{...D(),children:[i&&e.jsx(r,{...y(),alt:o}),F]})});ks.displayName="HeroUI.Avatar";var ae=ks,Fs=_e((s,a)=>{var t;const{as:r,className:i,children:n,...o}=s,c=r||"div",m=fe(a),{slots:g,classNames:h}=et(),v=je(h==null?void 0:h.header,i);return e.jsx(c,{ref:m,className:(t=g.header)==null?void 0:t.call(g,{class:v}),...o,children:n})});Fs.displayName="HeroUI.CardHeader";var K=Fs;function Nt(s){const[a,t]=ws(s,ds.variantKeys),{as:r,children:i,className:n,...o}=a,c=r||"code",m=q.useMemo(()=>ds({...t,className:n}),[Ps(t),n]);return{Component:c,children:i,getCodeProps:()=>({className:m,...o})}}var Ts=_e((s,a)=>{const{Component:t,children:r,getCodeProps:i}=Nt({...s});return e.jsx(t,{ref:a,...i(),children:r})});Ts.displayName="HeroUI.Code";var wt=Ts;function Pt(s){let{value:a=0,minValue:t=0,maxValue:r=100,valueLabel:i,isIndeterminate:n,formatOptions:o={style:"percent"}}=s,c=st(s,{labelable:!0}),{labelProps:m,fieldProps:g}=tt({...s,labelElementType:"span"});a=at(a,t,r);let h=(a-t)/(r-t),v=ft(o);if(!n&&!i){let p=o.style==="percent"?h:a;i=v.format(p)}return{progressBarProps:rt(c,{...g,"aria-valuenow":n?void 0:a,"aria-valuemin":t,"aria-valuemax":r,"aria-valuetext":n?void 0:i,role:"progressbar"}),labelProps:m}}function Rt(s){var a,t;const r=Ns(),[i,n]=ws(s,cs.variantKeys),{ref:o,as:c,id:m,className:g,classNames:h,label:v,valueLabel:p,value:D=0,minValue:y=0,maxValue:F=100,showValueLabel:I=!1,formatOptions:O={style:"percent"},...w}=i,S=c||"div",E=fe(o),G=je(h==null?void 0:h.base,g),[,b]=mt({rerender:!0,delay:100}),N=s.isIndeterminate,j=(t=(a=s.disableAnimation)!=null?a:r==null?void 0:r.disableAnimation)!=null?t:!1,{progressBarProps:R,labelProps:d}=Pt({id:m,label:v,value:D,minValue:y,maxValue:F,valueLabel:p,formatOptions:O,isIndeterminate:N,"aria-labelledby":s["aria-labelledby"],"aria-label":s["aria-label"]}),P=q.useMemo(()=>cs({...n,disableAnimation:j}),[Ps(n),j]),T=j?!0:b,f=q.useMemo(()=>N||!T?void 0:it((D-y)/(F-y)*100),[T,N,D,y,F]),l=q.useCallback((C={})=>({ref:E,"data-indeterminate":re(N),"data-disabled":re(s.isDisabled),className:P.base({class:G}),...ve(R,w,C)}),[E,P,N,s.isDisabled,G,R,w]),x=q.useCallback((C={})=>({className:P.label({class:h==null?void 0:h.label}),...ve(d,C)}),[P,h,d]);return{Component:S,domRef:E,slots:P,classNames:h,label:v,percentage:f,showValueLabel:I,getProgressBarProps:l,getLabelProps:x}}var Es=_e((s,a)=>{const{Component:t,slots:r,classNames:i,label:n,percentage:o,showValueLabel:c,getProgressBarProps:m,getLabelProps:g}=Rt({...s,ref:a}),h=m(),v=n||c;return e.jsxs(t,{...h,children:[v?e.jsxs("div",{className:r.labelWrapper({class:i==null?void 0:i.labelWrapper}),children:[n&&e.jsx("span",{...g(),children:n}),c&&e.jsx("span",{className:r.value({class:i==null?void 0:i.value}),children:h["aria-valuetext"]})]}):null,e.jsx("div",{className:r.track({class:i==null?void 0:i.track}),children:e.jsx("div",{className:r.indicator({class:i==null?void 0:i.indicator}),style:{transform:`translateX(-${100-(o||0)}%)`}})})]})});Es.displayName="HeroUI.Progress";var _t=Es,Gs=Symbol.for("immer-nothing"),us=Symbol.for("immer-draftable"),V=Symbol.for("immer-state");function J(s,...a){throw new Error(`[Immer] minified error nr: ${s}. Full error at: https://bit.ly/3cXEKWf`)}var ne=Object.getPrototypeOf;function oe(s){return!!s&&!!s[V]}function se(s){var a;return s?Os(s)||Array.isArray(s)||!!s[us]||!!((a=s.constructor)!=null&&a[us])||pe(s)||Oe(s):!1}var Dt=Object.prototype.constructor.toString();function Os(s){if(!s||typeof s!="object")return!1;const a=ne(s);if(a===null)return!0;const t=Object.hasOwnProperty.call(a,"constructor")&&a.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===Dt}function we(s,a){Ge(s)===0?Reflect.ownKeys(s).forEach(t=>{a(t,s[t],s)}):s.forEach((t,r)=>a(r,t,s))}function Ge(s){const a=s[V];return a?a.type_:Array.isArray(s)?1:pe(s)?2:Oe(s)?3:0}function We(s,a){return Ge(s)===2?s.has(a):Object.prototype.hasOwnProperty.call(s,a)}function zs(s,a,t){const r=Ge(s);r===2?s.set(a,t):r===3?s.add(t):s[a]=t}function Ct(s,a){return s===a?s!==0||1/s===1/a:s!==s&&a!==a}function pe(s){return s instanceof Map}function Oe(s){return s instanceof Set}function ee(s){return s.copy_||s.base_}function He(s,a){if(pe(s))return new Map(s);if(Oe(s))return new Set(s);if(Array.isArray(s))return Array.prototype.slice.call(s);const t=Os(s);if(a===!0||a==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(s);delete r[V];let i=Reflect.ownKeys(r);for(let n=0;n<i.length;n++){const o=i[n],c=r[o];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(r[o]={configurable:!0,writable:!0,enumerable:c.enumerable,value:s[o]})}return Object.create(ne(s),r)}else{const r=ne(s);if(r!==null&&t)return{...s};const i=Object.create(r);return Object.assign(i,s)}}function ss(s,a=!1){return ze(s)||oe(s)||!se(s)||(Ge(s)>1&&Object.defineProperties(s,{set:{value:ge},add:{value:ge},clear:{value:ge},delete:{value:ge}}),Object.freeze(s),a&&Object.values(s).forEach(t=>ss(t,!0))),s}function ge(){J(2)}function ze(s){return Object.isFrozen(s)}var St={};function te(s){const a=St[s];return a||J(0,s),a}var de;function As(){return de}function kt(s,a){return{drafts_:[],parent_:s,immer_:a,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function ms(s,a){a&&(te("Patches"),s.patches_=[],s.inversePatches_=[],s.patchListener_=a)}function Ke(s){Je(s),s.drafts_.forEach(Ft),s.drafts_=null}function Je(s){s===de&&(de=s.parent_)}function ps(s){return de=kt(de,s)}function Ft(s){const a=s[V];a.type_===0||a.type_===1?a.revoke_():a.revoked_=!0}function hs(s,a){a.unfinalizedDrafts_=a.drafts_.length;const t=a.drafts_[0];return s!==void 0&&s!==t?(t[V].modified_&&(Ke(a),J(4)),se(s)&&(s=Pe(a,s),a.parent_||Re(a,s)),a.patches_&&te("Patches").generateReplacementPatches_(t[V].base_,s,a.patches_,a.inversePatches_)):s=Pe(a,t,[]),Ke(a),a.patches_&&a.patchListener_(a.patches_,a.inversePatches_),s!==Gs?s:void 0}function Pe(s,a,t){if(ze(a))return a;const r=a[V];if(!r)return we(a,(i,n)=>xs(s,r,a,i,n,t)),a;if(r.scope_!==s)return a;if(!r.modified_)return Re(s,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const i=r.copy_;let n=i,o=!1;r.type_===3&&(n=new Set(i),i.clear(),o=!0),we(n,(c,m)=>xs(s,r,i,c,m,t,o)),Re(s,i,!1),t&&s.patches_&&te("Patches").generatePatches_(r,t,s.patches_,s.inversePatches_)}return r.copy_}function xs(s,a,t,r,i,n,o){if(oe(i)){const c=n&&a&&a.type_!==3&&!We(a.assigned_,r)?n.concat(r):void 0,m=Pe(s,i,c);if(zs(t,r,m),oe(m))s.canAutoFreeze_=!1;else return}else o&&t.add(i);if(se(i)&&!ze(i)){if(!s.immer_.autoFreeze_&&s.unfinalizedDrafts_<1)return;Pe(s,i),(!a||!a.scope_.parent_)&&typeof r!="symbol"&&(pe(t)?t.has(r):Object.prototype.propertyIsEnumerable.call(t,r))&&Re(s,i)}}function Re(s,a,t=!1){!s.parent_&&s.immer_.autoFreeze_&&s.canAutoFreeze_&&ss(a,t)}function Tt(s,a){const t=Array.isArray(s),r={type_:t?1:0,scope_:a?a.scope_:As(),modified_:!1,finalized_:!1,assigned_:{},parent_:a,base_:s,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,n=ts;t&&(i=[r],n=ue);const{revoke:o,proxy:c}=Proxy.revocable(i,n);return r.draft_=c,r.revoke_=o,c}var ts={get(s,a){if(a===V)return s;const t=ee(s);if(!We(t,a))return Et(s,t,a);const r=t[a];return s.finalized_||!se(r)?r:r===Be(s.base_,a)?(Ue(s),s.copy_[a]=Ze(r,s)):r},has(s,a){return a in ee(s)},ownKeys(s){return Reflect.ownKeys(ee(s))},set(s,a,t){const r=Is(ee(s),a);if(r!=null&&r.set)return r.set.call(s.draft_,t),!0;if(!s.modified_){const i=Be(ee(s),a),n=i==null?void 0:i[V];if(n&&n.base_===t)return s.copy_[a]=t,s.assigned_[a]=!1,!0;if(Ct(t,i)&&(t!==void 0||We(s.base_,a)))return!0;Ue(s),Ye(s)}return s.copy_[a]===t&&(t!==void 0||a in s.copy_)||Number.isNaN(t)&&Number.isNaN(s.copy_[a])||(s.copy_[a]=t,s.assigned_[a]=!0),!0},deleteProperty(s,a){return Be(s.base_,a)!==void 0||a in s.base_?(s.assigned_[a]=!1,Ue(s),Ye(s)):delete s.assigned_[a],s.copy_&&delete s.copy_[a],!0},getOwnPropertyDescriptor(s,a){const t=ee(s),r=Reflect.getOwnPropertyDescriptor(t,a);return r&&{writable:!0,configurable:s.type_!==1||a!=="length",enumerable:r.enumerable,value:t[a]}},defineProperty(){J(11)},getPrototypeOf(s){return ne(s.base_)},setPrototypeOf(){J(12)}},ue={};we(ts,(s,a)=>{ue[s]=function(){return arguments[0]=arguments[0][0],a.apply(this,arguments)}});ue.deleteProperty=function(s,a){return ue.set.call(this,s,a,void 0)};ue.set=function(s,a,t){return ts.set.call(this,s[0],a,t,s[0])};function Be(s,a){const t=s[V];return(t?ee(t):s)[a]}function Et(s,a,t){var i;const r=Is(a,t);return r?"value"in r?r.value:(i=r.get)==null?void 0:i.call(s.draft_):void 0}function Is(s,a){if(!(a in s))return;let t=ne(s);for(;t;){const r=Object.getOwnPropertyDescriptor(t,a);if(r)return r;t=ne(t)}}function Ye(s){s.modified_||(s.modified_=!0,s.parent_&&Ye(s.parent_))}function Ue(s){s.copy_||(s.copy_=He(s.base_,s.scope_.immer_.useStrictShallowCopy_))}var Gt=class{constructor(s){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(a,t,r)=>{if(typeof a=="function"&&typeof t!="function"){const n=t;t=a;const o=this;return function(m=n,...g){return o.produce(m,h=>t.call(this,h,...g))}}typeof t!="function"&&J(6),r!==void 0&&typeof r!="function"&&J(7);let i;if(se(a)){const n=ps(this),o=Ze(a,void 0);let c=!0;try{i=t(o),c=!1}finally{c?Ke(n):Je(n)}return ms(n,r),hs(i,n)}else if(!a||typeof a!="object"){if(i=t(a),i===void 0&&(i=a),i===Gs&&(i=void 0),this.autoFreeze_&&ss(i,!0),r){const n=[],o=[];te("Patches").generateReplacementPatches_(a,i,n,o),r(n,o)}return i}else J(1,a)},this.produceWithPatches=(a,t)=>{if(typeof a=="function")return(o,...c)=>this.produceWithPatches(o,m=>a(m,...c));let r,i;return[this.produce(a,t,(o,c)=>{r=o,i=c}),r,i]},typeof(s==null?void 0:s.autoFreeze)=="boolean"&&this.setAutoFreeze(s.autoFreeze),typeof(s==null?void 0:s.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(s.useStrictShallowCopy)}createDraft(s){se(s)||J(8),oe(s)&&(s=Ot(s));const a=ps(this),t=Ze(s,void 0);return t[V].isManual_=!0,Je(a),t}finishDraft(s,a){const t=s&&s[V];(!t||!t.isManual_)&&J(9);const{scope_:r}=t;return ms(r,a),hs(void 0,r)}setAutoFreeze(s){this.autoFreeze_=s}setUseStrictShallowCopy(s){this.useStrictShallowCopy_=s}applyPatches(s,a){let t;for(t=a.length-1;t>=0;t--){const i=a[t];if(i.path.length===0&&i.op==="replace"){s=i.value;break}}t>-1&&(a=a.slice(t+1));const r=te("Patches").applyPatches_;return oe(s)?r(s,a):this.produce(s,i=>r(i,a))}};function Ze(s,a){const t=pe(s)?te("MapSet").proxyMap_(s,a):Oe(s)?te("MapSet").proxySet_(s,a):Tt(s,a);return(a?a.scope_:As()).drafts_.push(t),t}function Ot(s){return oe(s)||J(10,s),Ms(s)}function Ms(s){if(!se(s)||ze(s))return s;const a=s[V];let t;if(a){if(!a.modified_)return a.base_;a.finalized_=!0,t=He(s,a.scope_.immer_.useStrictShallowCopy_)}else t=He(s,!0);return we(t,(r,i)=>{zs(t,r,Ms(i))}),a&&(a.finalized_=!1),t}var zt=new Gt,At=zt.produce;const It=s=>(a,t,r)=>(r.setState=(i,n,...o)=>{const c=typeof i=="function"?At(i):i;return a(c,n,...o)},s(r.setState,t,r)),Mt=It,H=s=>s.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),gs=s=>({Shelter:"lucide:home",Toilet:"lucide:bath",Bridge:"lucide:route",Access:"lucide:wheelchair",Seating:"lucide:armchair",Lighting:"lucide:lamp"})[s]||"lucide:box",fs=s=>({Shelter:"Outdoor structures for shade and protection",Toilet:"Public and portable sanitation facilities",Bridge:"Pedestrian and light vehicle crossings",Access:"Ramps, stairs, and accessibility solutions",Seating:"Benches and outdoor furniture options",Lighting:"Outdoor and pathway lighting solutions"})[s]||"Product category",js=s=>({Peninsula:"Modern shelters with excellent weather protection for parks and urban settings",Whyalla:"Robust shelters designed for coastal and high-wind environments",Coastal:"Corrosion-resistant designs perfect for beachfront and marine locations",Urban:"Contemporary designs that blend with modern city landscapes",Heritage:"Traditional designs that complement historic and cultural settings",EcoSan:"Environmentally friendly composting toilet solutions with minimal water usage",Standard:"Reliable and cost-effective public toilet facilities",Accessible:"Fully compliant accessible toilet facilities with enhanced features",Premium:"High-end toilet facilities with superior finishes and amenities",Compact:"Space-saving designs for areas with limited footprint","Small Span":"Compact bridges for garden paths and small water crossings","Large Span":"Extended bridges for wider crossings and heavier loads",Pedestrian:"Dedicated walkways designed for high foot traffic areas",Decorative:"Ornamental bridges that serve as landscape features","Heavy Duty":"Reinforced bridges capable of supporting maintenance vehicles"})[s]||`${s} product range`,vs=s=>{const a={Peninsula:["Modern","Weather-resistant","Versatile"],Whyalla:["Robust","Wind-resistant","Durable"],Coastal:["Corrosion-resistant","Salt-proof","UV-stable"],Urban:["Contemporary","Modular","Space-efficient"],Heritage:["Traditional","Ornate","Classic"],EcoSan:["Eco-friendly","Low-water","Composting"],Standard:["Cost-effective","Reliable","Low-maintenance"],Accessible:["ADA Compliant","Spacious","Universal"],Premium:["High-end","Enhanced features","Superior finishes"],Compact:["Space-saving","Efficient","Urban-friendly"],"Small Span":["Compact","Decorative","Easy-install"],"Large Span":["Extended","Reinforced","Heavy-load"],Pedestrian:["High-traffic","Safety-focused","Accessible"],Decorative:["Ornamental","Artistic","Feature piece"],"Heavy Duty":["Vehicle-rated","Industrial","Maximum strength"],default:["Quality","Durable","Customizable"]};return a[s]||a.default},qe={id:1,stepperForm:{steps:[{step:1,title:"Select Product Group",categories:[]},{step:2,title:"Select Product Range",ranges:{}},{step:3,title:"Select Individual Product",products:{}},{step:4,title:"View Product Content",productDetails:{}},{step:5,title:"Configure Options",options:{}},{step:6,title:"Contact Information",fields:[{name:"fullName",label:"Full Name",type:"text",required:!0},{name:"email",label:"Email Address",type:"email",required:!0},{name:"phone",label:"Phone Number",type:"tel",required:!1},{name:"company",label:"Company/Organization",type:"text",required:!1},{name:"message",label:"Additional Notes",type:"textarea",required:!1}]}]}},X=nt()(ot(Mt((s,a)=>({productData:qe,productGroups:[],productRanges:[],products:[],relationships:{groupToRanges:{},rangeToProducts:{}},isDirty:!1,isSaving:!1,isLoading:!1,lastSaved:null,error:null,initializeFromWindowData:()=>{const t=window.urbanaAdmin;if(!t){console.warn("No urbanaAdmin window data found");return}t.stepperFormData&&(console.log("Loading stepper form data:",t.stepperFormData),s(r=>{r.productData=t.stepperFormData})),t.stepperDataBuilder&&typeof t.stepperDataBuilder=="object"&&t.stepperDataBuilder.productGroups&&t.stepperDataBuilder.productGroups.length>0?(console.log("Loading existing data builder data:",t.stepperDataBuilder),s(r=>{r.productGroups=t.stepperDataBuilder.productGroups||[],r.productRanges=t.stepperDataBuilder.productRanges||[],r.products=t.stepperDataBuilder.products||[],r.relationships=t.stepperDataBuilder.relationships||{groupToRanges:{},rangeToProducts:{}},t.stepperDataBuilder.lastSaved&&(r.lastSaved=new Date(t.stepperDataBuilder.lastSaved)),r.isDirty=!1})):(console.log("No existing data builder data found, extracting from stepper form data"),t.stepperFormData&&a().initializeFromProductData(t.stepperFormData))},loadData:async t=>{var r;if(!t){a().initializeFromWindowData();return}s(i=>{i.isLoading=!0,i.error=null});try{const i=await fetch(`/wp-json/urbana/v1/data-builder/${t}`,{method:"GET",headers:{"X-WP-Nonce":((r=window.urbanaAdmin)==null?void 0:r.nonce)||""}});if(!i.ok)throw new Error(`Failed to load data: ${i.status} ${i.statusText}`);const n=await i.json();n.stepper_form_data&&s(o=>{o.productData=n.stepper_form_data}),n.stepper_data_builder&&typeof n.stepper_data_builder=="object"&&n.stepper_data_builder.productGroups&&n.stepper_data_builder.productGroups.length>0?(console.log("Loading existing API data builder data:",n.stepper_data_builder),s(o=>{o.productGroups=n.stepper_data_builder.productGroups||[],o.productRanges=n.stepper_data_builder.productRanges||[],o.products=n.stepper_data_builder.products||[],o.relationships=n.stepper_data_builder.relationships||{groupToRanges:{},rangeToProducts:{}},n.stepper_data_builder.lastSaved&&(o.lastSaved=new Date(n.stepper_data_builder.lastSaved))})):(console.log("No existing API data builder data found, extracting from stepper form data"),n.stepper_form_data&&a().initializeFromProductData(n.stepper_form_data))}catch(i){const n=i instanceof Error?i.message:"Unknown error occurred";throw console.error("Error loading data:",n),s(o=>{o.error=n}),i}finally{s(i=>{i.isLoading=!1})}},getRangesForGroup:t=>{const{productRanges:r,relationships:i}=a(),n=i.groupToRanges[t]||[];return r.filter(o=>n.includes(o.id))},getProductsForRange:t=>{const{products:r,relationships:i}=a(),n=i.rangeToProducts[t]||[];return r.filter(o=>n.includes(o.id))},getProductById:t=>{const{products:r}=a();return r.find(i=>i.id===t)},getGroupById:t=>{const{productGroups:r}=a();return r.find(i=>i.id===t)},getRangeById:t=>{const{productRanges:r}=a();return r.find(i=>i.id===t)},saveData:async()=>{var t;s(r=>{r.isSaving=!0,r.error=null});try{const r=a().exportData(),{productGroups:i,productRanges:n,products:o,relationships:c}=a(),m=await fetch("/wp-json/urbana/v1/product-data",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":((t=window.urbanaAdmin)==null?void 0:t.nonce)||""},body:JSON.stringify({stepper_form_data:r,stepper_data_builder:{productGroups:i,productRanges:n,products:o,relationships:c,lastSaved:new Date().toISOString()}})});if(!m.ok)throw new Error(`Failed to save data: ${m.status} ${m.statusText}`);const g=await m.json();return s(h=>{h.productData=r,h.isDirty=!1,h.lastSaved=new Date}),console.log("Data saved successfully, stepper ID:",g.stepper_id),g.stepper_id}catch(r){const i=r instanceof Error?r.message:"Unknown error occurred";throw console.error("Error saving data:",i),s(n=>{n.error=i}),r}finally{s(r=>{r.isSaving=!1})}},initializeFromProductData:t=>s(r=>{r.productData=t;const i=(t.stepperForm.steps[0].categories||[]).map(g=>({id:H(g),name:g,icon:gs(g),description:fs(g)}));r.productGroups=i;const n=[];Object.entries(t.stepperForm.steps[1].ranges||{}).forEach(([g,h])=>{h.forEach(v=>{n.push({id:H(v),name:v,image:"",description:js(v),tags:vs(v)})})}),r.productRanges=n;const o=[];Object.entries(t.stepperForm.steps[2].products||{}).forEach(([g,h])=>{h.forEach(v=>{var D;const p=(D=t.stepperForm.steps[3].productDetails)==null?void 0:D[v];o.push({id:H(v),code:v,name:(p==null?void 0:p.name)||`${v} Product`,overview:(p==null?void 0:p.overview)||"",description:(p==null?void 0:p.description)||"",specifications:(p==null?void 0:p.specifications)||[],imageGallery:(p==null?void 0:p.imageGallery)||[],files:(p==null?void 0:p.files)||{}})})}),r.products=o;const c={};Object.entries(t.stepperForm.steps[1].ranges||{}).forEach(([g,h])=>{const v=H(g);c[v]=h.map(p=>H(p))});const m={};Object.entries(t.stepperForm.steps[2].products||{}).forEach(([g,h])=>{const v=H(g);m[v]=h.map(p=>H(p))}),r.relationships={groupToRanges:c,rangeToProducts:m}}),updateProductData:t=>s(r=>{r.productData=t,r.isDirty=!0}),exportData:()=>{const{productGroups:t,productRanges:r,products:i,relationships:n,productData:o}=a();return{id:o.id,stepperForm:{steps:[{step:1,title:"Select Product Group",categories:t.map(m=>m.name)},{step:2,title:"Select Product Range",ranges:(()=>{const m={};return Object.entries(n.groupToRanges).forEach(([g,h])=>{const v=t.find(p=>p.id===g);v&&(m[v.name]=h.map(p=>{const D=r.find(y=>y.id===p);return D?D.name:""}).filter(p=>p!==""))}),m})()},{step:3,title:"Select Individual Product",products:(()=>{const m={};return Object.entries(n.rangeToProducts).forEach(([g,h])=>{const v=r.find(p=>p.id===g);v&&(m[v.name]=h.map(p=>{const D=i.find(y=>y.id===p);return D?D.code:""}).filter(p=>p!==""))}),m})()},{step:4,title:"View Product Content",productDetails:(()=>{const m={};return i.forEach(g=>{m[g.code]={name:g.name,overview:g.overview,description:g.description,specifications:g.specifications,imageGallery:g.imageGallery,files:g.files}}),m})()},o.stepperForm.steps[4]||{step:5,title:"Configure Options",options:{}},o.stepperForm.steps[5]||{step:6,title:"Contact Information",fields:qe.stepperForm.steps[5].fields}]}}},addProductGroup:t=>s(r=>{const i=H(t.name),n={...t,id:i,icon:t.icon||gs(t.name),description:t.description||fs(t.name)};r.productGroups.some(c=>c.id===i)||(r.productGroups.push(n),r.relationships.groupToRanges[i]=[],r.isDirty=!0)}),updateProductGroup:(t,r)=>s(i=>{const n=i.productGroups.findIndex(o=>o.id===t);n!==-1&&(i.productGroups[n]={...i.productGroups[n],...r},i.isDirty=!0)}),removeProductGroup:t=>s(r=>{r.productGroups=r.productGroups.filter(n=>n.id!==t),(r.relationships.groupToRanges[t]||[]).forEach(n=>{r.productRanges=r.productRanges.filter(c=>c.id!==n),(r.relationships.rangeToProducts[n]||[]).forEach(c=>{r.products=r.products.filter(m=>m.id!==c)}),delete r.relationships.rangeToProducts[n]}),delete r.relationships.groupToRanges[t],r.isDirty=!0}),addProductRange:t=>s(r=>{const i=H(t.name),n={...t,id:i,description:t.description||js(t.name),tags:t.tags||vs(t.name)};r.productRanges.some(c=>c.id===i)||(r.productRanges.push(n),r.relationships.rangeToProducts[i]=[],r.isDirty=!0)}),updateProductRange:(t,r)=>s(i=>{const n=i.productRanges.findIndex(o=>o.id===t);n!==-1&&(i.productRanges[n]={...i.productRanges[n],...r},i.isDirty=!0)}),removeProductRange:t=>s(r=>{r.productRanges=r.productRanges.filter(n=>n.id!==t),(r.relationships.rangeToProducts[t]||[]).forEach(n=>{r.products=r.products.filter(o=>o.id!==n)}),Object.keys(r.relationships.groupToRanges).forEach(n=>{r.relationships.groupToRanges[n]=r.relationships.groupToRanges[n].filter(o=>o!==t)}),delete r.relationships.rangeToProducts[t],r.isDirty=!0}),addProduct:t=>s(r=>{const i=H(t.code||t.name),n={...t,id:i,code:t.code||H(t.name)};r.products.some(c=>c.id===i)||(r.products.push(n),r.isDirty=!0)}),updateProduct:(t,r)=>s(i=>{const n=i.products.findIndex(o=>o.id===t);n!==-1&&(i.products[n]={...i.products[n],...r},i.isDirty=!0)}),removeProduct:t=>s(r=>{r.products=r.products.filter(i=>i.id!==t),Object.keys(r.relationships.rangeToProducts).forEach(i=>{r.relationships.rangeToProducts[i]=r.relationships.rangeToProducts[i].filter(n=>n!==t)}),r.isDirty=!0}),linkRangeToGroup:(t,r)=>s(i=>{i.relationships.groupToRanges[t]||(i.relationships.groupToRanges[t]=[]),i.relationships.groupToRanges[t].includes(r)||(i.relationships.groupToRanges[t].push(r),i.isDirty=!0)}),unlinkRangeFromGroup:(t,r)=>s(i=>{i.relationships.groupToRanges[t]&&(i.relationships.groupToRanges[t]=i.relationships.groupToRanges[t].filter(n=>n!==r),i.isDirty=!0)}),linkProductToRange:(t,r)=>s(i=>{i.relationships.rangeToProducts[t]||(i.relationships.rangeToProducts[t]=[]),i.relationships.rangeToProducts[t].includes(r)||(i.relationships.rangeToProducts[t].push(r),i.isDirty=!0)}),unlinkProductFromRange:(t,r)=>s(i=>{i.relationships.rangeToProducts[t]&&(i.relationships.rangeToProducts[t]=i.relationships.rangeToProducts[t].filter(n=>n!==r),i.isDirty=!0)}),updateRelationships:t=>s(r=>{r.relationships=t,r.isDirty=!0}),updateOptions:t=>s(r=>{r.productData.stepperForm.steps[4]&&(r.productData.stepperForm.steps[4].options=t,r.isDirty=!0)}),updateContactFields:t=>s(r=>{r.productData.stepperForm.steps[5]&&(r.productData.stepperForm.steps[5].fields=t,r.isDirty=!0)}),resetData:()=>s(t=>{t.productData=qe,t.productGroups=[],t.productRanges=[],t.products=[],t.relationships={groupToRanges:{},rangeToProducts:{}},t.isDirty=!1,t.lastSaved=null,t.error=null}),importData:t=>s(r=>{r.isDirty=!0,r.lastSaved=null,r.error=null,a().initializeFromProductData(t)}),setError:t=>s(r=>{r.error=t}),clearError:()=>s(t=>{t.error=null})})),{name:"urbana-data-builder"})),$t=({selectedIcon:s,onIconSelect:a})=>{const t=["lucide:box","lucide:home","lucide:bath","lucide:route","lucide:wheelchair","lucide:armchair","lucide:lamp","lucide:tree","lucide:building","lucide:car","lucide:tools","lucide:shield"];return e.jsx("div",{className:"grid grid-cols-6 gap-2",children:t.map(r=>e.jsx(k,{isIconOnly:!0,variant:s===r?"solid":"bordered",color:s===r?"primary":"default",onPress:()=>a(r),className:"h-12 w-12",children:e.jsx(u,{icon:r,width:20})},r))})},Lt=()=>{const{productGroups:s,addProductGroup:a,updateProductGroup:t,removeProductGroup:r,getRangesForGroup:i}=X(),{isOpen:n,onOpen:o,onOpenChange:c,onClose:m}=De(),[g,h]=z.useState(null),[v,p]=z.useState({name:"",icon:"lucide:box",description:""}),[D,y]=z.useState({}),F=()=>{h(null),p({name:"",icon:"lucide:box",description:""}),y({}),o()},I=b=>{h(b),p({name:b.name,icon:b.icon,description:b.description}),y({}),o()},O=b=>{const N=i(b).length,j=N>0?`Are you sure you want to delete this product group? This will also remove ${N} associated range(s) and their products.`:"Are you sure you want to delete this product group?";confirm(j)&&r(b)},w=(b,N)=>{p(j=>({...j,[b]:N})),D[b]&&y(j=>({...j,[b]:""}))},S=b=>{p(N=>({...N,icon:b}))},E=()=>{const b={};return v.name.trim()||(b.name="Name is required"),s.some(j=>j.name.toLowerCase()===v.name.toLowerCase()&&(!g||j.id!==g.id))&&(b.name="A product group with this name already exists"),v.description.trim()||(b.description="Description is required"),y(b),Object.keys(b).length===0},G=()=>{E()&&(g?t(g.id,v):a(v),m())};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Product Groups"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Organize your products into logical categories"})]}),e.jsx(k,{color:"primary",onPress:F,startContent:e.jsx(u,{icon:"lucide:plus",width:18}),children:"Add Product Group"})]}),s.length===0?e.jsx(A,{children:e.jsx($,{className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(u,{icon:"lucide:layers",width:48,className:"text-foreground-300"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground-600",children:"No Product Groups Yet"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Create your first product group to get started"})]}),e.jsx(k,{color:"primary",onPress:F,startContent:e.jsx(u,{icon:"lucide:plus",width:18}),children:"Add Product Group"})]})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(b=>{const N=i(b.id).length;return e.jsxs(A,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(K,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start w-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ae,{icon:e.jsx(u,{icon:b.icon,width:20}),className:"bg-primary-100 text-primary-800",size:"sm"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold",children:b.name}),e.jsxs(L,{size:"sm",variant:"flat",color:"primary",children:[N," range",N!==1?"s":""]})]})]}),e.jsxs(Xe,{children:[e.jsx(Qe,{children:e.jsx(k,{isIconOnly:!0,variant:"light",size:"sm",children:e.jsx(u,{icon:"lucide:more-vertical",width:16})})}),e.jsxs(es,{"aria-label":"Group Actions",children:[e.jsx(ie,{startContent:e.jsx(u,{icon:"lucide:edit",width:16}),onPress:()=>I(b),children:"Edit"},"edit"),e.jsx(ie,{className:"text-danger",color:"danger",startContent:e.jsx(u,{icon:"lucide:trash",width:16}),onPress:()=>O(b.id),children:"Delete"},"delete")]})]})]})}),e.jsx($,{className:"pt-0",children:e.jsx("p",{className:"text-sm text-foreground-600",children:b.description})})]},b.id)})}),e.jsx(Ce,{isOpen:n,onOpenChange:c,size:"lg",children:e.jsx(Se,{children:b=>e.jsxs(e.Fragment,{children:[e.jsx(ke,{children:g?"Edit Product Group":"Add Product Group"}),e.jsx(Fe,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Y,{label:"Name",placeholder:"Enter group name",value:v.name,onChange:N=>w("name",N.target.value),errorMessage:D.name,isInvalid:!!D.name,isRequired:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground-700 mb-2 block",children:"Icon"}),e.jsx($t,{selectedIcon:v.icon,onIconSelect:S})]}),e.jsx(ce,{label:"Description",placeholder:"Enter group description",value:v.description,onChange:N=>w("description",N.target.value),errorMessage:D.description,isInvalid:!!D.description,isRequired:!0,rows:3})]})}),e.jsxs(Te,{children:[e.jsx(k,{variant:"light",onPress:b,children:"Cancel"}),e.jsxs(k,{color:"primary",onPress:G,children:[g?"Update":"Add"," Group"]})]})]})})})]})},Bt=({tags:s,onTagsChange:a})=>{const[t,r]=z.useState(""),i=o=>{if(o.key==="Enter"&&t.trim()){o.preventDefault();const c=t.trim();s.includes(c)||a([...s,c]),r("")}},n=o=>{a(s.filter(c=>c!==o))};return e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{placeholder:"Type a tag and press Enter",value:t,onChange:o=>r(o.target.value),onKeyDown:i}),s.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(o=>e.jsx(L,{onClose:()=>n(o),variant:"flat",size:"sm",children:o},o))})]})},Ut=()=>{const{productRanges:s,productGroups:a,addProductRange:t,updateProductRange:r,removeProductRange:i,getProductsForRange:n,linkRangeToGroup:o,unlinkRangeFromGroup:c,relationships:m}=X(),{isOpen:g,onOpen:h,onOpenChange:v,onClose:p}=De(),[D,y]=z.useState(null),[F,I]=z.useState({name:"",image:"",description:"",tags:[]}),[O,w]=z.useState(new Set),[S,E]=z.useState({}),G=()=>{y(null),I({name:"",image:"",description:"",tags:[]}),w(new Set),E({}),h()},b=l=>{y(l),I({name:l.name,image:l.image,description:l.description,tags:[...l.tags]});const x=new Set;Object.entries(m.groupToRanges).forEach(([C,M])=>{M.includes(l.id)&&x.add(C)}),w(x),E({}),h()},N=l=>{const x=n(l).length,C=x>0?`Are you sure you want to delete this product range? This will also remove ${x} associated product(s).`:"Are you sure you want to delete this product range?";confirm(C)&&i(l)},j=(l,x)=>{I(C=>({...C,[l]:x})),S[l]&&E(C=>({...C,[l]:""}))},R=()=>{const l={};return F.name.trim()||(l.name="Name is required"),s.some(C=>C.name.toLowerCase()===F.name.toLowerCase()&&(!D||C.id!==D.id))&&(l.name="A product range with this name already exists"),F.description.trim()||(l.description="Description is required"),O.size===0&&(l.groups="Please select at least one product group"),E(l),Object.keys(l).length===0},d=()=>{if(!R())return;let l;D?(r(D.id,F),l=D.id,Object.keys(m.groupToRanges).forEach(x=>{c(x,D.id)})):(t(F),l=F.name.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")),O.forEach(x=>{o(x,l)}),p()},P=()=>{const l={},x=[];return s.forEach(C=>{let M=!1;Object.entries(m.groupToRanges).forEach(([_,B])=>{if(B.includes(C.id)){const Z=a.find(Ae=>Ae.id===_);Z&&(l[Z.name]||(l[Z.name]=[]),l[Z.name].push(C),M=!0)}}),M||x.push(C)}),{grouped:l,ungrouped:x}},{grouped:T,ungrouped:f}=P();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Product Ranges"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Define specific product lines within each group"})]}),e.jsx(k,{color:"primary",onPress:G,startContent:e.jsx(u,{icon:"lucide:plus",width:18}),isDisabled:a.length===0,children:"Add Product Range"})]}),a.length===0?e.jsx(A,{children:e.jsx($,{className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(u,{icon:"lucide:alert-circle",width:48,className:"text-warning-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground-600",children:"No Product Groups Available"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"You need to create product groups first before adding ranges"})]})]})})}):s.length===0?e.jsx(A,{children:e.jsx($,{className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(u,{icon:"lucide:grid-3x3",width:48,className:"text-foreground-300"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground-600",children:"No Product Ranges Yet"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Create your first product range to organize your products"})]}),e.jsx(k,{color:"primary",onPress:G,startContent:e.jsx(u,{icon:"lucide:plus",width:18}),children:"Add Product Range"})]})})}):e.jsxs("div",{className:"space-y-6",children:[Object.entries(T).map(([l,x])=>e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:layers",width:18}),l,e.jsxs(L,{size:"sm",variant:"flat",children:[x.length," range",x.length!==1?"s":""]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:x.map(C=>e.jsx(bs,{range:C,onEdit:b,onDelete:N},C.id))})]},l)),f.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold mb-3 flex items-center gap-2 text-warning-600",children:[e.jsx(u,{icon:"lucide:alert-triangle",width:18}),"Ungrouped Ranges",e.jsxs(L,{size:"sm",variant:"flat",color:"warning",children:[f.length," range",f.length!==1?"s":""]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(l=>e.jsx(bs,{range:l,onEdit:b,onDelete:N},l.id))})]})]}),e.jsx(Ce,{isOpen:g,onOpenChange:v,size:"2xl",children:e.jsx(Se,{children:l=>e.jsxs(e.Fragment,{children:[e.jsx(ke,{children:D?"Edit Product Range":"Add Product Range"}),e.jsx(Fe,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Y,{label:"Name",placeholder:"Enter range name",value:F.name,onChange:x=>j("name",x.target.value),errorMessage:S.name,isInvalid:!!S.name,isRequired:!0}),e.jsx(be,{label:"Product Groups",placeholder:"Select product groups for this range",selectionMode:"multiple",selectedKeys:O,onSelectionChange:x=>w(x),errorMessage:S.groups,isInvalid:!!S.groups,isRequired:!0,children:a.map(x=>e.jsx(ye,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{icon:x.icon,width:16}),x.name]})},x.id))}),e.jsx(Y,{label:"Image URL",placeholder:"Enter image URL (optional)",value:F.image,onChange:x=>j("image",x.target.value)}),e.jsx(ce,{label:"Description",placeholder:"Enter range description",value:F.description,onChange:x=>j("description",x.target.value),errorMessage:S.description,isInvalid:!!S.description,isRequired:!0,rows:3}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground-700 mb-2 block",children:"Tags"}),e.jsx(Bt,{tags:F.tags,onTagsChange:x=>j("tags",x)})]})]})}),e.jsxs(Te,{children:[e.jsx(k,{variant:"light",onPress:l,children:"Cancel"}),e.jsxs(k,{color:"primary",onPress:d,children:[D?"Update":"Add"," Range"]})]})]})})})]})},bs=({range:s,onEdit:a,onDelete:t})=>{const{getProductsForRange:r}=X(),i=r(s.id).length;return e.jsxs(A,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(K,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start w-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.image?e.jsx(_s,{src:s.image,alt:s.name,width:40,height:40,className:"rounded-lg object-cover"}):e.jsx("div",{className:"w-10 h-10 bg-secondary-100 rounded-lg flex items-center justify-center",children:e.jsx(u,{icon:"lucide:grid-3x3",width:20,className:"text-secondary-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold",children:s.name}),e.jsxs(L,{size:"sm",variant:"flat",color:"secondary",children:[i," product",i!==1?"s":""]})]})]}),e.jsxs(Xe,{children:[e.jsx(Qe,{children:e.jsx(k,{isIconOnly:!0,variant:"light",size:"sm",children:e.jsx(u,{icon:"lucide:more-vertical",width:16})})}),e.jsxs(es,{"aria-label":"Range Actions",children:[e.jsx(ie,{startContent:e.jsx(u,{icon:"lucide:edit",width:16}),onPress:()=>a(s),children:"Edit"},"edit"),e.jsx(ie,{className:"text-danger",color:"danger",startContent:e.jsx(u,{icon:"lucide:trash",width:16}),onPress:()=>t(s.id),children:"Delete"},"delete")]})]})]})}),e.jsxs($,{className:"pt-0",children:[e.jsx("p",{className:"text-sm text-foreground-600 mb-2",children:s.description}),s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:s.tags.map(n=>e.jsx(L,{size:"sm",variant:"flat",color:"default",children:n},n))})]})]})},qt=({files:s,onFilesChange:a})=>{const[t,r]=z.useState(""),[i,n]=z.useState(""),o=()=>{t.trim()&&i.trim()&&(a({...s,[t.trim()]:i.trim()}),r(""),n(""))},c=m=>{const g={...s};delete g[m],a(g)};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Y,{placeholder:"File name",value:t,onChange:m=>r(m.target.value),size:"sm"}),e.jsx(Y,{placeholder:"File URL",value:i,onChange:m=>n(m.target.value),size:"sm"}),e.jsx(k,{size:"sm",color:"primary",onPress:o,isDisabled:!t.trim()||!i.trim(),children:"Add"})]}),Object.entries(s).length>0&&e.jsx("div",{className:"space-y-2",children:Object.entries(s).map(([m,g])=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-sm",children:m}),e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:g})]}),e.jsx(k,{size:"sm",variant:"light",color:"danger",onPress:()=>c(m),children:"Remove"})]},m))})]})},Vt=({specifications:s,onSpecificationsChange:a})=>{const[t,r]=z.useState(""),i=()=>{t.trim()&&!s.includes(t.trim())&&(a([...s,t.trim()]),r(""))},n=o=>{a(s.filter(c=>c!==o))};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Y,{placeholder:"Add specification",value:t,onChange:o=>r(o.target.value),onKeyPress:o=>o.key==="Enter"&&i(),size:"sm"}),e.jsx(k,{size:"sm",color:"primary",onPress:i,isDisabled:!t.trim(),children:"Add"})]}),s.length>0&&e.jsx("div",{className:"space-y-2",children:s.map((o,c)=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm",children:o}),e.jsx(k,{size:"sm",variant:"light",color:"danger",onPress:()=>n(o),children:"Remove"})]},c))})]})},Wt=()=>{const{products:s,productRanges:a,addProduct:t,updateProduct:r,removeProduct:i,linkProductToRange:n,unlinkProductFromRange:o,relationships:c}=X(),{isOpen:m,onOpen:g,onOpenChange:h,onClose:v}=De(),[p,D]=z.useState(null),[y,F]=z.useState({code:"",name:"",overview:"",description:"",specifications:[],imageGallery:[],files:{}}),[I,O]=z.useState(new Set),[w,S]=z.useState({}),E=()=>{D(null),F({code:"",name:"",overview:"",description:"",specifications:[],imageGallery:[],files:{}}),O(new Set),S({}),g()},G=f=>{D(f),F({code:f.code,name:f.name,overview:f.overview,description:f.description,specifications:[...f.specifications],imageGallery:[...f.imageGallery],files:{...f.files}});const l=new Set;Object.entries(c.rangeToProducts).forEach(([x,C])=>{C.includes(f.id)&&l.add(x)}),O(l),S({}),g()},b=f=>{confirm("Are you sure you want to delete this product?")&&i(f)},N=(f,l)=>{if(F(x=>({...x,[f]:l})),f==="name"&&!y.code&&typeof l=="string"){const x=l.toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"");F(C=>({...C,code:x}))}w[f]&&S(x=>({...x,[f]:""}))},j=()=>{const f={};return y.code.trim()||(f.code="Product code is required"),s.some(x=>x.code.toLowerCase()===y.code.toLowerCase()&&(!p||x.id!==p.id))&&(f.code="A product with this code already exists"),y.name.trim()||(f.name="Product name is required"),y.overview.trim()||(f.overview="Product overview is required"),y.description.trim()||(f.description="Product description is required"),I.size===0&&(f.ranges="Please select at least one product range"),S(f),Object.keys(f).length===0},R=()=>{if(!j())return;let f;p?(r(p.id,y),f=p.id,Object.keys(c.rangeToProducts).forEach(l=>{o(l,p.id)})):(t(y),f=(y.code||y.name).toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")),I.forEach(l=>{n(l,f)}),v()},d=()=>{const f={},l=[];return s.forEach(x=>{let C=!1;Object.entries(c.rangeToProducts).forEach(([M,_])=>{if(_.includes(x.id)){const B=a.find(Z=>Z.id===M);B&&(f[B.name]||(f[B.name]=[]),f[B.name].push(x),C=!0)}}),C||l.push(x)}),{grouped:f,ungrouped:l}},{grouped:P,ungrouped:T}=d();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Products"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Manage individual products with detailed specifications"})]}),e.jsx(k,{color:"primary",onPress:E,startContent:e.jsx(u,{icon:"lucide:plus",width:18}),isDisabled:a.length===0,children:"Add Product"})]}),a.length===0?e.jsx(A,{children:e.jsx($,{className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(u,{icon:"lucide:alert-circle",width:48,className:"text-warning-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground-600",children:"No Product Ranges Available"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"You need to create product ranges first before adding products"})]})]})})}):s.length===0?e.jsx(A,{children:e.jsx($,{className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(u,{icon:"lucide:package",width:48,className:"text-foreground-300"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground-600",children:"No Products Yet"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Create your first product to get started"})]}),e.jsx(k,{color:"primary",onPress:E,startContent:e.jsx(u,{icon:"lucide:plus",width:18}),children:"Add Product"})]})})}):e.jsxs("div",{className:"space-y-6",children:[Object.entries(P).map(([f,l])=>e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:grid-3x3",width:18}),f,e.jsxs(L,{size:"sm",variant:"flat",children:[l.length," product",l.length!==1?"s":""]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(x=>e.jsx(ys,{product:x,onEdit:G,onDelete:b},x.id))})]},f)),T.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold mb-3 flex items-center gap-2 text-warning-600",children:[e.jsx(u,{icon:"lucide:alert-triangle",width:18}),"Ungrouped Products",e.jsxs(L,{size:"sm",variant:"flat",color:"warning",children:[T.length," product",T.length!==1?"s":""]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:T.map(f=>e.jsx(ys,{product:f,onEdit:G,onDelete:b},f.id))})]})]}),e.jsx(Ce,{isOpen:m,onOpenChange:h,size:"3xl",scrollBehavior:"inside",children:e.jsx(Se,{children:f=>e.jsxs(e.Fragment,{children:[e.jsx(ke,{children:p?"Edit Product":"Add Product"}),e.jsx(Fe,{children:e.jsxs(Ee,{"aria-label":"Product Details",defaultSelectedKey:"basic",children:[e.jsx(U,{title:"Basic Info",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Y,{label:"Product Code",placeholder:"e.g., SH-PEN-001",value:y.code,onChange:l=>N("code",l.target.value),errorMessage:w.code,isInvalid:!!w.code,isRequired:!0}),e.jsx(Y,{label:"Product Name",placeholder:"Enter product name",value:y.name,onChange:l=>N("name",l.target.value),errorMessage:w.name,isInvalid:!!w.name,isRequired:!0})]}),e.jsx(be,{label:"Product Ranges",placeholder:"Select product ranges",selectionMode:"multiple",selectedKeys:I,onSelectionChange:l=>O(l),errorMessage:w.ranges,isInvalid:!!w.ranges,isRequired:!0,children:a.map(l=>e.jsx(ye,{children:l.name},l.id))}),e.jsx(ce,{label:"Overview",placeholder:"Brief product overview",value:y.overview,onChange:l=>N("overview",l.target.value),errorMessage:w.overview,isInvalid:!!w.overview,isRequired:!0,rows:2}),e.jsx(ce,{label:"Description",placeholder:"Detailed product description",value:y.description,onChange:l=>N("description",l.target.value),errorMessage:w.description,isInvalid:!!w.description,isRequired:!0,rows:4})]})},"basic"),e.jsx(U,{title:"Specifications",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground-700 mb-2 block",children:"Product Specifications"}),e.jsx(Vt,{specifications:y.specifications,onSpecificationsChange:l=>N("specifications",l)})]})})},"specifications"),e.jsx(U,{title:"Files & Images",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground-700 mb-2 block",children:"Image Gallery (URLs)"}),e.jsxs("div",{className:"space-y-2",children:[y.imageGallery.map((l,x)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Y,{placeholder:"Image URL",value:l,onChange:C=>{const M=[...y.imageGallery];M[x]=C.target.value,N("imageGallery",M)},size:"sm"}),e.jsx(k,{size:"sm",variant:"light",color:"danger",onPress:()=>{const C=y.imageGallery.filter((M,_)=>_!==x);N("imageGallery",C)},children:"Remove"})]},x)),e.jsx(k,{size:"sm",variant:"flat",onPress:()=>N("imageGallery",[...y.imageGallery,""]),children:"Add Image"})]})]}),e.jsx(lt,{}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground-700 mb-2 block",children:"Product Files"}),e.jsx(qt,{files:y.files,onFilesChange:l=>N("files",l)})]})]})},"files")]})}),e.jsxs(Te,{children:[e.jsx(k,{variant:"light",onPress:f,children:"Cancel"}),e.jsxs(k,{color:"primary",onPress:R,children:[p?"Update":"Add"," Product"]})]})]})})})]})},ys=({product:s,onEdit:a,onDelete:t})=>{const r=s.imageGallery.length>0&&s.imageGallery[0];return e.jsxs(A,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(K,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start w-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[r?e.jsx(_s,{src:s.imageGallery[0],alt:s.name,width:40,height:40,className:"rounded-lg object-cover"}):e.jsx("div",{className:"w-10 h-10 bg-success-100 rounded-lg flex items-center justify-center",children:e.jsx(u,{icon:"lucide:package",width:20,className:"text-success-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold",children:s.name}),e.jsx(L,{size:"sm",variant:"flat",color:"success",children:s.code})]})]}),e.jsxs(Xe,{children:[e.jsx(Qe,{children:e.jsx(k,{isIconOnly:!0,variant:"light",size:"sm",children:e.jsx(u,{icon:"lucide:more-vertical",width:16})})}),e.jsxs(es,{"aria-label":"Product Actions",children:[e.jsx(ie,{startContent:e.jsx(u,{icon:"lucide:edit",width:16}),onPress:()=>a(s),children:"Edit"},"edit"),e.jsx(ie,{className:"text-danger",color:"danger",startContent:e.jsx(u,{icon:"lucide:trash",width:16}),onPress:()=>t(s.id),children:"Delete"},"delete")]})]})]})}),e.jsxs($,{className:"pt-0",children:[e.jsx("p",{className:"text-sm text-foreground-600 mb-2",children:s.overview}),s.specifications.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-semibold text-foreground-700",children:"Specifications:"}),e.jsxs("div",{className:"text-xs text-foreground-500",children:[s.specifications.slice(0,3).map((i,n)=>e.jsxs("div",{children:["• ",i]},n)),s.specifications.length>3&&e.jsxs("div",{children:["... and ",s.specifications.length-3," more"]})]})]})]})]})},Ht=()=>{const{productGroups:s,productRanges:a,products:t,relationships:r,linkRangeToGroup:i,unlinkRangeFromGroup:n,linkProductToRange:o,unlinkProductFromRange:c}=X(),[m,g]=z.useState(null),[h,v]=z.useState(null),[p,D]=z.useState(!1),y=()=>s.map(d=>{const P=r.groupToRanges[d.id]||[],T=P.map(f=>{const l=a.find(M=>M.id===f),x=r.rangeToProducts[f]||[],C=x.map(M=>{const _=t.find(B=>B.id===M);return{id:M,name:(_==null?void 0:_.name)||"Unknown Product",code:_==null?void 0:_.code,overview:_==null?void 0:_.overview,type:"product",hasIssues:!_}}).filter(Boolean);return{id:f,name:(l==null?void 0:l.name)||"Unknown Range",description:l==null?void 0:l.description,type:"range",children:C,hasIssues:!l||x.length===0}}).filter(Boolean);return{id:d.id,name:d.name,description:d.description,type:"group",children:T,hasIssues:P.length===0}}),F=()=>{const d=a.filter(T=>!Object.values(r.groupToRanges).some(f=>f.includes(T.id))),P=t.filter(T=>!Object.values(r.rangeToProducts).some(f=>f.includes(T.id)));return{orphanedRanges:d,orphanedProducts:P}},I=()=>{const{orphanedRanges:d,orphanedProducts:P}=F(),T=Object.values(r.groupToRanges).reduce((l,x)=>l+x.length,0)+Object.values(r.rangeToProducts).reduce((l,x)=>l+x.length,0),f=Math.round((s.length-s.filter(l=>(r.groupToRanges[l.id]||[]).length===0).length+(a.length-d.length)+(t.length-P.length))/(s.length+a.length+t.length)*100);return{totalConnections:T,orphanedRanges:d.length,orphanedProducts:P.length,completionRate:isNaN(f)?0:f}},O=(d,P)=>{i(d,P)},w=(d,P)=>{n(d,P)},S=(d,P)=>{o(d,P)},E=(d,P)=>{c(d,P)},G=async()=>{D(!0),await new Promise(d=>setTimeout(d,1500)),D(!1)},b=y(),{orphanedRanges:N,orphanedProducts:j}=F(),R=I();return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Relationship Manager"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Manage connections between groups, ranges, and products"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(k,{color:"secondary",variant:"flat",onPress:G,startContent:e.jsx(u,{icon:"lucide:search",width:18}),isLoading:p,children:p?"Analyzing...":"Analyze Structure"})})]}),e.jsx(A,{className:"mb-6",children:e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-600",children:R.totalConnections}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Total Connections"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-warning-600",children:R.orphanedRanges}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Orphaned Ranges"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-danger-600",children:R.orphanedProducts}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Orphaned Products"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-success-600",children:[R.completionRate,"%"]}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Structure Complete"}),e.jsx(_t,{value:R.completionRate,color:R.completionRate>80?"success":R.completionRate>50?"warning":"danger",size:"sm",className:"mt-1"})]})]})})}),e.jsxs(Ee,{"aria-label":"Relationship Views",defaultSelectedKey:"tree",children:[e.jsx(U,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:git-branch",width:16}),"Tree View"]}),children:e.jsxs("div",{className:"space-y-4",children:[b.length===0?e.jsx(A,{children:e.jsx($,{className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(u,{icon:"lucide:git-branch",width:48,className:"text-foreground-300"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground-600",children:"No Structure Yet"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Create groups, ranges, and products to see the relationship tree"})]})]})})}):e.jsx(Ds,{selectionMode:"multiple",variant:"bordered",children:b.map(d=>{var P;return e.jsx(Cs,{title:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ae,{icon:e.jsx(u,{icon:"lucide:folder",width:16}),className:"w-6 h-6 bg-primary-100 text-primary-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:d.name}),d.hasIssues&&e.jsx(u,{icon:"lucide:alert-triangle",width:16,className:"text-warning-500"})]}),e.jsx("div",{className:"text-xs text-foreground-500",children:d.description||"No description"})]}),e.jsx(os,{content:((P=d.children)==null?void 0:P.length)||0,color:"primary",size:"sm",children:e.jsx("div",{className:"w-4 h-4"})})]}),children:d.children&&d.children.length>0?e.jsx("div",{className:"space-y-3 pl-4",children:d.children.map(T=>{var f;return e.jsxs("div",{className:"border-l-2 border-gray-200 pl-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(ae,{icon:e.jsx(u,{icon:"lucide:grid-3x3",width:16}),className:"w-6 h-6 bg-secondary-100 text-secondary-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:T.name}),T.hasIssues&&e.jsx(u,{icon:"lucide:alert-triangle",width:16,className:"text-warning-500"})]}),e.jsx("div",{className:"text-xs text-foreground-500",children:T.description||"No description"})]}),e.jsx(os,{content:((f=T.children)==null?void 0:f.length)||0,color:"secondary",size:"sm",children:e.jsx("div",{className:"w-4 h-4"})})]}),T.children&&T.children.length>0&&e.jsx("div",{className:"space-y-2 pl-8",children:T.children.map(l=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded-lg",children:[e.jsx(ae,{icon:e.jsx(u,{icon:"lucide:package",width:16}),className:"w-5 h-5 bg-success-100 text-success-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:l.name}),l.code&&e.jsx(L,{size:"sm",variant:"flat",color:"success",children:l.code}),l.hasIssues&&e.jsx(u,{icon:"lucide:alert-triangle",width:14,className:"text-warning-500"})]}),l.overview&&e.jsx("div",{className:"text-xs text-foreground-500",children:l.overview})]})]},l.id))})]},T.id)})}):e.jsxs("div",{className:"text-center py-6 text-foreground-400",children:[e.jsx(u,{icon:"lucide:inbox",width:32,className:"mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:"No ranges linked to this group"})]})},d.id)})}),(N.length>0||j.length>0)&&e.jsxs(A,{className:"border-warning-200 bg-warning-50",children:[e.jsx(K,{children:e.jsxs("div",{className:"flex items-center gap-2 text-warning-700",children:[e.jsx(u,{icon:"lucide:alert-triangle",width:20}),e.jsx("h4",{className:"font-semibold",children:"Orphaned Items"})]})}),e.jsxs($,{className:"pt-0",children:[N.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Unlinked Ranges:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:N.map(d=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white rounded border",children:[e.jsx(u,{icon:"lucide:grid-3x3",width:16,className:"text-secondary-600"}),e.jsx("span",{className:"text-sm",children:d.name}),e.jsx("span",{className:"text-xs text-gray-500",children:d.description})]},d.id))})]}),j.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Unlinked Products:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:j.map(d=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white rounded border",children:[e.jsx(u,{icon:"lucide:package",width:16,className:"text-success-600"}),e.jsx("span",{className:"text-sm",children:d.name}),e.jsx(L,{size:"sm",variant:"flat",color:"success",children:d.code})]},d.id))})]})]})]})]})},"tree"),e.jsx(U,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:link",width:16}),"Manage Links"]}),children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(A,{children:[e.jsx(K,{children:e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:arrow-right",width:16}),"Group → Range Links"]})}),e.jsx($,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(be,{label:"Select Group",placeholder:"Choose a product group",selectedKeys:m?new Set([m]):new Set,onSelectionChange:d=>g(Array.from(d)[0]||null),children:s.map(d=>e.jsx(ye,{children:d.name},d.id))}),m&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm font-medium text-foreground-700",children:"Available Ranges:"}),a.map(d=>{const P=(r.groupToRanges[m]||[]).includes(d.id);return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{icon:"lucide:grid-3x3",width:16,className:"text-secondary-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:d.name}),e.jsx("div",{className:"text-xs text-foreground-500",children:d.description})]})]}),e.jsx(k,{size:"sm",color:P?"danger":"primary",variant:P?"flat":"solid",onPress:()=>{P?w(m,d.id):O(m,d.id)},children:P?"Unlink":"Link"})]},d.id)})]})]})})]}),e.jsxs(A,{children:[e.jsx(K,{children:e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:arrow-right",width:16}),"Range → Product Links"]})}),e.jsx($,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(be,{label:"Select Range",placeholder:"Choose a product range",selectedKeys:h?new Set([h]):new Set,onSelectionChange:d=>v(Array.from(d)[0]||null),children:a.map(d=>e.jsx(ye,{children:d.name},d.id))}),h&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm font-medium text-foreground-700",children:"Available Products:"}),t.map(d=>{const P=(r.rangeToProducts[h]||[]).includes(d.id);return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{icon:"lucide:package",width:16,className:"text-success-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:d.name}),e.jsx("div",{className:"text-xs text-foreground-500",children:d.code})]})]}),e.jsx(k,{size:"sm",color:P?"danger":"primary",variant:P?"flat":"solid",onPress:()=>{P?E(h,d.id):S(h,d.id)},children:P?"Unlink":"Link"})]},d.id)})]})]})})]})]})},"manage"),e.jsx(U,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:bar-chart-3",width:16}),"Analysis"]}),children:e.jsx("div",{className:"space-y-6",children:p?e.jsx(A,{children:e.jsxs($,{className:"text-center py-12",children:[e.jsx(Rs,{size:"lg",color:"primary"}),e.jsx("p",{className:"mt-4 text-foreground-600",children:"Analyzing relationship structure..."})]})}):e.jsxs(e.Fragment,{children:[e.jsxs(A,{children:[e.jsx(K,{children:e.jsx("h4",{className:"font-semibold",children:"Structure Analysis"})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Groups"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Total Groups"}),e.jsx("span",{className:"text-sm font-medium",children:s.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"With Ranges"}),e.jsx("span",{className:"text-sm font-medium",children:s.filter(d=>(r.groupToRanges[d.id]||[]).length>0).length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Empty Groups"}),e.jsx("span",{className:"text-sm font-medium text-warning-600",children:s.filter(d=>(r.groupToRanges[d.id]||[]).length===0).length})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Ranges"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Total Ranges"}),e.jsx("span",{className:"text-sm font-medium",children:a.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Linked to Groups"}),e.jsx("span",{className:"text-sm font-medium",children:a.length-N.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"With Products"}),e.jsx("span",{className:"text-sm font-medium",children:a.filter(d=>(r.rangeToProducts[d.id]||[]).length>0).length})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Products"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Total Products"}),e.jsx("span",{className:"text-sm font-medium",children:t.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Linked to Ranges"}),e.jsx("span",{className:"text-sm font-medium",children:t.length-j.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Orphaned"}),e.jsx("span",{className:"text-sm font-medium text-danger-600",children:j.length})]})]})]})]})})]}),e.jsxs(A,{children:[e.jsx(K,{children:e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:lightbulb",width:16}),"Recommendations"]})}),e.jsx($,{children:e.jsxs("div",{className:"space-y-3",children:[R.orphanedProducts>0&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-danger-50 rounded-lg border border-danger-200",children:[e.jsx(u,{icon:"lucide:alert-triangle",width:16,className:"text-danger-600 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-danger-800",children:["You have ",R.orphanedProducts," unlinked product",R.orphanedProducts!==1?"s":""]}),e.jsx("p",{className:"text-xs text-danger-600",children:"Link these products to ranges so they appear in your product stepper."})]})]}),R.orphanedRanges>0&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-warning-50 rounded-lg border border-warning-200",children:[e.jsx(u,{icon:"lucide:alert-triangle",width:16,className:"text-warning-600 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-warning-800",children:["You have ",R.orphanedRanges," unlinked range",R.orphanedRanges!==1?"s":""]}),e.jsx("p",{className:"text-xs text-warning-600",children:"Link these ranges to product groups to organize your structure."})]})]}),s.filter(d=>(r.groupToRanges[d.id]||[]).length===0).length>0&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-primary-50 rounded-lg border border-primary-200",children:[e.jsx(u,{icon:"lucide:info",width:16,className:"text-primary-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-primary-800",children:"Some product groups are empty"}),e.jsx("p",{className:"text-xs text-primary-600",children:"Consider linking ranges to these groups or removing unused groups."})]})]}),R.completionRate>=90&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-success-50 rounded-lg border border-success-200",children:[e.jsx(u,{icon:"lucide:check-circle",width:16,className:"text-success-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-success-800",children:"Great job! Your structure is well organized"}),e.jsx("p",{className:"text-xs text-success-600",children:"Your data structure is ready for the product stepper."})]})]})]})})]})]})})},"analysis")]})]})},Kt=()=>{const{productGroups:s,productRanges:a,products:t,relationships:r,exportData:i,importData:n}=X(),{isOpen:o,onOpen:c,onOpenChange:m,onClose:g}=De(),[h,v]=z.useState(""),[p,D]=z.useState(""),[y,F]=z.useState("structure"),I=()=>({stepperForm:{steps:s.map((R,d)=>{const P=r.groupToRanges[R.id]||[],T=P.map(l=>{const x=a.find(C=>C.id===l);return(x==null?void 0:x.name)||"Unknown Range"}),f={};return P.forEach(l=>{const x=a.find(C=>C.id===l);if(x){const C=r.rangeToProducts[l]||[];f[x.name]=C.map(M=>{const _=t.find(B=>B.id===M);return{id:(_==null?void 0:_.id)||M,code:(_==null?void 0:_.code)||"",name:(_==null?void 0:_.name)||"Unknown Product",overview:(_==null?void 0:_.overview)||"",description:(_==null?void 0:_.description)||"",specifications:(_==null?void 0:_.specifications)||[],imageGallery:(_==null?void 0:_.imageGallery)||[],files:(_==null?void 0:_.files)||{}}})}}),{step:d+1,title:R.name,categories:T.length>0?T:void 0,products:f}})}}),O=()=>{const j=i();D(JSON.stringify(j,null,2)),F("json")},w=()=>{try{const j=JSON.parse(h);n(j),v(""),g()}catch{alert("Invalid JSON format. Please check your data.")}},S=()=>{const j=I(),R=JSON.stringify(j,null,2),d="data:application/json;charset=utf-8,"+encodeURIComponent(R),P="stepper-config.json",T=document.createElement("a");T.setAttribute("href",d),T.setAttribute("download",P),T.click()},E=()=>{const j=I();navigator.clipboard.writeText(JSON.stringify(j,null,2))},G=I(),b={};G.stepperForm.steps.forEach(j=>{j.products&&Object.entries(j.products).forEach(([R,d])=>{b[R]||(b[R]=[]),b[R].push(...d)})});const N={totalSteps:G.stepperForm.steps.length,totalCategories:Object.keys(b).length,totalProducts:Object.values(b).reduce((j,R)=>j+R.length,0),hasIssues:G.stepperForm.steps.some(j=>!j.categories||j.categories.length===0)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Data Preview"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Preview and export your stepper configuration"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{variant:"flat",onPress:c,startContent:e.jsx(u,{icon:"lucide:upload",width:18}),children:"Import"}),e.jsx(k,{color:"secondary",onPress:O,startContent:e.jsx(u,{icon:"lucide:download",width:18}),children:"Export Data"}),e.jsx(k,{color:"primary",onPress:S,startContent:e.jsx(u,{icon:"lucide:file-down",width:18}),children:"Download Config"})]})]}),e.jsx(A,{className:"mb-6",children:e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-600",children:N.totalSteps}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Stepper Steps"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-secondary-600",children:N.totalCategories}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Categories"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-success-600",children:N.totalProducts}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Products"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-2xl font-bold ${N.hasIssues?"text-warning-600":"text-success-600"}`,children:N.hasIssues?e.jsx(u,{icon:"lucide:alert-triangle",width:32}):e.jsx(u,{icon:"lucide:check-circle",width:32})}),e.jsx("div",{className:"text-sm text-foreground-500",children:N.hasIssues?"Has Issues":"Ready"})]})]})})}),e.jsxs(Ee,{"aria-label":"Preview Options",selectedKey:y,onSelectionChange:j=>F(j),children:[e.jsx(U,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:layers",width:16}),"Structure Preview"]}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(A,{children:[e.jsx(K,{children:e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:list",width:16}),"Stepper Steps"]})}),e.jsx($,{children:G.stepperForm.steps.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(u,{icon:"lucide:layers",width:48,className:"mx-auto text-foreground-300 mb-4"}),e.jsx("p",{className:"text-foreground-600",children:"No stepper steps configured"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Create product groups to generate stepper steps"})]}):e.jsx("div",{className:"space-y-4",children:G.stepperForm.steps.map(j=>e.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold text-primary-600",children:j.step})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-semibold",children:j.title}),j.categories&&j.categories.length>0?e.jsx("div",{className:"flex gap-1 mt-1",children:j.categories.map((R,d)=>e.jsx(L,{size:"sm",variant:"flat",color:"secondary",children:R},d))}):e.jsxs("p",{className:"text-sm text-warning-600 mt-1",children:[e.jsx(u,{icon:"lucide:alert-triangle",width:14,className:"inline mr-1"}),"No categories linked"]})]})]},j.step))})})]}),e.jsxs(A,{children:[e.jsx(K,{children:e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:package",width:16}),"Products by Category"]})}),e.jsx($,{children:Object.keys(b).length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(u,{icon:"lucide:package",width:48,className:"mx-auto text-foreground-300 mb-4"}),e.jsx("p",{className:"text-foreground-600",children:"No products configured"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Link products to ranges to see them here"})]}):e.jsx(Ds,{variant:"bordered",children:Object.entries(b).map(([j,R])=>e.jsx(Cs,{title:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ae,{icon:e.jsx(u,{icon:"lucide:grid-3x3",width:16}),className:"w-6 h-6 bg-secondary-100 text-secondary-600"}),e.jsx("span",{className:"font-medium",children:j}),e.jsxs(L,{size:"sm",variant:"flat",color:"secondary",children:[R.length," product",R.length!==1?"s":""]})]}),children:e.jsx("div",{className:"space-y-3 pl-4",children:R.map(d=>e.jsx("div",{className:"border-l-2 border-success-200 pl-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ae,{icon:e.jsx(u,{icon:"lucide:package",width:16}),className:"w-8 h-8 bg-success-100 text-success-600 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h6",{className:"font-semibold",children:d.name}),e.jsx(L,{size:"sm",variant:"flat",color:"success",children:d.code})]}),e.jsx("p",{className:"text-sm text-foreground-600 mb-2",children:d.overview}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-foreground-700",children:"Specifications:"}),e.jsx("span",{className:"text-foreground-500 ml-1",children:d.specifications.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-foreground-700",children:"Images:"}),e.jsx("span",{className:"text-foreground-500 ml-1",children:d.imageGallery.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-foreground-700",children:"Files:"}),e.jsx("span",{className:"text-foreground-500 ml-1",children:Object.keys(d.files).length})]})]})]})]})},d.id))})},j))})})]})]})},"structure"),e.jsx(U,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:code",width:16}),"JSON Preview"]}),children:e.jsxs(A,{children:[e.jsxs(K,{className:"flex flex-row justify-between items-center",children:[e.jsx("h4",{className:"font-semibold",children:"Configuration JSON"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{size:"sm",variant:"flat",onPress:E,startContent:e.jsx(u,{icon:"lucide:copy",width:16}),children:"Copy"}),e.jsx(k,{size:"sm",color:"primary",onPress:S,startContent:e.jsx(u,{icon:"lucide:download",width:16}),children:"Download"})]})]}),e.jsx($,{children:e.jsx(wt,{className:"w-full max-h-96 overflow-auto text-xs",children:p||JSON.stringify(G,null,2)})})]})},"json")]}),e.jsx(Ce,{isOpen:o,onOpenChange:m,size:"2xl",children:e.jsx(Se,{children:j=>e.jsxs(e.Fragment,{children:[e.jsx(ke,{children:"Import Configuration"}),e.jsx(Fe,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-3 bg-warning-50 border border-warning-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(u,{icon:"lucide:alert-triangle",width:16,className:"text-warning-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-warning-800",children:"Warning"}),e.jsx("p",{className:"text-xs text-warning-600",children:"Importing will replace all current data. Make sure to export your current configuration first if needed."})]})]})}),e.jsx(ce,{label:"JSON Data",placeholder:"Paste your exported JSON configuration here...",value:h,onChange:R=>v(R.target.value),rows:12,className:"font-mono text-sm"})]})}),e.jsxs(Te,{children:[e.jsx(k,{variant:"light",onPress:j,children:"Cancel"}),e.jsx(k,{color:"primary",onPress:w,isDisabled:!h.trim(),children:"Import"})]})]})})})]})},Jt=()=>{const{productGroups:s,productRanges:a,products:t,relationships:r,exportData:i,importData:n,error:o,productData:c,loadData:m,saveData:g,isLoading:h,initializeFromWindowData:v}=X(),[p,D]=q.useState(null);q.useEffect(()=>{const w=window.urbanaAdmin;w&&(v(),D(w.stepperId||1))},[v]);const y=async()=>{try{const w=await g();w&&D(w)}catch(w){console.error("Failed to save data:",w)}},F=async w=>{try{const S=new URL(window.location.href);S.searchParams.set("stepper_id",w.toString()),window.location.href=S.toString()}catch(S){console.error("Failed to load data builder:",S)}},I=()=>{const w=i(),S="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(w,null,2)),E=document.createElement("a");E.setAttribute("href",S),E.setAttribute("download","product-configurator-data.json"),document.body.appendChild(E),E.click(),E.remove()},O=w=>{var G;const S=(G=w.target.files)==null?void 0:G[0];if(!S)return;const E=new FileReader;E.onload=b=>{var N;try{const j=JSON.parse((N=b.target)==null?void 0:N.result);n(j),w.target.value=""}catch(j){console.error("Error parsing imported data:",j),alert("Invalid data format. Please check your JSON file.")}},E.readAsText(S)};return e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-semibold text-foreground",children:["Data Management",p&&e.jsxs("span",{className:"text-sm text-foreground-500 ml-2",children:["(Stepper ID: ",p,")"]})]}),e.jsx("p",{className:"text-sm text-foreground-500 mt-1",children:"Manage product groups, ranges, products, and their relationships"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{color:"success",variant:"flat",onPress:y,isLoading:h,startContent:e.jsx(u,{icon:"lucide:save",width:18}),children:"Save Data"}),e.jsx(k,{color:"primary",variant:"flat",onPress:I,startContent:e.jsx(u,{icon:"lucide:download",width:18}),children:"Export Data"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx(k,{color:"primary",variant:"flat",as:"span",startContent:e.jsx(u,{icon:"lucide:upload",width:18}),children:"Import Data"}),e.jsx("input",{type:"file",accept:".json",className:"hidden",onChange:O})]})]})]}),e.jsx(A,{className:"p-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"Switch to Stepper ID:"}),e.jsx("input",{type:"number",min:"1",className:"px-3 py-2 border rounded-md w-20",placeholder:"ID",onKeyDown:w=>{if(w.key==="Enter"){const S=parseInt(w.target.value);S>0&&F(S)}}}),e.jsx(k,{size:"sm",color:"primary",variant:"flat",onPress:()=>{const w=document.querySelector('input[type="number"]'),S=parseInt(w.value);S>0&&F(S)},children:"Switch"})]})}),e.jsx(A,{className:"p-0",children:e.jsxs(Ee,{"aria-label":"Data Builder Tabs",fullWidth:!0,classNames:{tabList:"gap-0"},children:[e.jsx(U,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:layers",width:18}),e.jsx("span",{children:"Product Groups"}),e.jsx("span",{className:"text-xs bg-primary-100 text-primary-800 px-2 py-0.5 rounded-full",children:s.length})]}),children:e.jsx("div",{className:"p-6",children:e.jsx(Lt,{})})},"groups"),e.jsx(U,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:grid-3x3",width:18}),e.jsx("span",{children:"Product Ranges"}),e.jsx("span",{className:"text-xs bg-secondary-100 text-secondary-800 px-2 py-0.5 rounded-full",children:a.length})]}),children:e.jsx("div",{className:"p-6",children:e.jsx(Ut,{})})},"ranges"),e.jsx(U,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:package",width:18}),e.jsx("span",{children:"Products"}),e.jsx("span",{className:"text-xs bg-success-100 text-success-800 px-2 py-0.5 rounded-full",children:t.length})]}),children:e.jsx("div",{className:"p-6",children:e.jsx(Wt,{})})},"products"),e.jsx(U,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:link",width:18}),e.jsx("span",{children:"Relationships"})]}),children:e.jsx("div",{className:"p-6",children:e.jsx(Ht,{})})},"relationships"),e.jsx(U,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{icon:"lucide:eye",width:18}),e.jsx("span",{children:"Data Preview"})]}),children:e.jsx("div",{className:"p-6",children:e.jsx(Kt,{})})},"preview")]})})]})};function Yt(){const{productGroups:s,isDirty:a,isSaving:t,isLoading:r,error:i,lastSaved:n,saveData:o,loadData:c,clearError:m,initializeFromWindowData:g}=X();z.useEffect(()=>{window.urbanaAdmin&&s.length===0&&(console.log("App initializing from window data"),g())},[g,s.length]);const h=async()=>{try{m(),await o()}catch(p){console.error("Save failed:",p)}},v=async()=>{try{m(),await c()}catch(p){console.error("Load failed:",p)}};return r?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(Rs,{size:"lg"}),e.jsx("p",{className:"text-foreground-600",children:"Loading product data..."})]})}):e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"py-6 px-4 sm:px-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Product Data Builder"}),e.jsx("p",{className:"text-foreground-500 mt-2",children:"Create and manage product configuration data"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[n&&e.jsxs("div",{className:"text-sm text-foreground-500 text-right",children:[e.jsx("div",{children:"Last saved:"}),e.jsx("div",{className:"font-medium",children:new Date(n).toLocaleString()})]}),e.jsx(k,{variant:"flat",color:"primary",startContent:e.jsx(u,{icon:"lucide:refresh-cw",width:18}),onPress:v,isLoading:r,children:"Refresh Data"}),a&&e.jsx(k,{color:"primary",startContent:e.jsx(u,{icon:"lucide:save",width:18}),onPress:h,isLoading:t,isDisabled:t,children:t?"Saving...":"Save Changes"})]})]}),i&&e.jsx(ls,{color:"danger",variant:"flat",className:"mb-6",title:"Error",description:i,endContent:e.jsx(k,{variant:"light",color:"danger",size:"sm",onPress:m,children:"Dismiss"})}),a&&!i&&e.jsx(ls,{color:"warning",variant:"flat",className:"mb-6",title:"Unsaved Changes",description:"You have unsaved changes. Don't forget to save your work!"}),e.jsx(Jt,{})]})})}ct.createRoot(document.getElementById("urbana-data-builder-root")).render(e.jsx(z.StrictMode,{children:e.jsxs(dt,{children:[e.jsx(pt,{}),e.jsx("main",{className:"text-foreground bg-background",children:e.jsx(Yt,{})})]})}));
